<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1 2025 Race Calendar Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
        }
        #map {
            height: 100vh;
            width: 100%;
        }
        .leaflet-popup-content-wrapper {
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .leaflet-popup-content {
            margin: 15px;
            font-size: 14px;
            line-height: 1.6;
        }
        .leaflet-popup-content h3 {
            margin: 0 0 10px;
            font-size: 18px;
            color: #d90429;
        }
        .leaflet-popup-content p {
            margin: 5px 0;
        }
        .leaflet-popup-content a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
        }
        .leaflet-popup-content a:hover {
            text-decoration: underline;
        }
        .leaflet-popup-tip {
            background: #ffffff;
        }
        .marker-icon {
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>

<div id="map"></div>

<script>
    // --- Map Initialization ---
    const map = L.map('map').setView([20, 15], 2);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
        subdomains: 'abcd',
        maxZoom: 19
    }).addTo(map);

    // --- F1 2025 Race Data ---
    const races = [
        { name: "Australian Grand Prix", city: "Melbourne", date: "2025-03-16", coords: [-37.8497, 144.968], timeIST: "09:30 AM", tickets: "australian-grand-prix" },
        { name: "Chinese Grand Prix", city: "Shanghai", date: "2025-03-23", coords: [31.3389, 121.2206], timeIST: "12:30 PM", tickets: "chinese-grand-prix" },
        { name: "Japanese Grand Prix", city: "Suzuka", date: "2025-04-06", coords: [34.8431, 136.541], timeIST: "10:30 AM", tickets: "japanese-grand-prix" },
        { name: "Bahrain Grand Prix", city: "Sakhir", date: "2025-04-13", coords: [26.0325, 50.5106], timeIST: "08:30 PM", tickets: "bahrain-grand-prix" },
        { name: "Saudi Arabian Grand Prix", city: "Jeddah", date: "2025-04-20", coords: [21.6319, 39.1044], timeIST: "10:30 PM", tickets: "saudi-arabian-grand-prix" },
        { name: "Miami Grand Prix", city: "Miami", date: "2025-05-04", coords: [25.9581, -80.2389], timeIST: "01:00 AM (Mon)", tickets: "miami-grand-prix" },
        { name: "Emilia Romagna Grand Prix", city: "Imola", date: "2025-05-18", coords: [44.3439, 11.7169], timeIST: "06:30 PM", tickets: "emilia-romagna-grand-prix" },
        { name: "Monaco Grand Prix", city: "Monaco", date: "2025-05-25", coords: [43.7347, 7.4206], timeIST: "06:30 PM", tickets: "monaco-grand-prix" },
        { name: "Spanish Grand Prix", city: "Barcelona", date: "2025-06-01", coords: [41.5700, 2.2611], timeIST: "06:30 PM", tickets: "spanish-grand-prix" },
        { name: "Canadian Grand Prix", city: "Montreal", date: "2025-06-15", coords: [45.5000, -73.5222], timeIST: "11:30 PM", tickets: "canadian-grand-prix" },
        { name: "Austrian Grand Prix", city: "Spielberg", date: "2025-06-29", coords: [47.2197, 14.7647], timeIST: "06:30 PM", tickets: "austrian-grand-prix" },
        { name: "British Grand Prix", city: "Silverstone", date: "2025-07-06", coords: [52.0786, -1.0169], timeIST: "07:30 PM", tickets: "british-grand-prix" },
        { name: "Belgian Grand Prix", city: "Spa", date: "2025-07-27", coords: [50.4372, 5.9714], timeIST: "06:30 PM", tickets: "belgian-grand-prix" },
        { name: "Hungarian Grand Prix", city: "Budapest", date: "2025-08-03", coords: [47.5789, 19.2486], timeIST: "06:30 PM", tickets: "hungarian-grand-prix" },
        { name: "Dutch Grand Prix", city: "Zandvoort", date: "2025-08-31", coords: [52.3888, 4.5409], timeIST: "06:30 PM", tickets: "dutch-grand-prix" },
        { name: "Italian Grand Prix", city: "Monza", date: "2025-09-07", coords: [45.6156, 9.2811], timeIST: "06:30 PM", tickets: "italian-grand-prix" },
        { name: "Azerbaijan Grand Prix", city: "Baku", date: "2025-09-21", coords: [40.3725, 49.8533], timeIST: "04:30 PM", tickets: "azerbaijan-grand-prix" },
        { name: "Singapore Grand Prix", city: "Singapore", date: "2025-10-05", coords: [1.2914, 103.864], timeIST: "05:30 PM", tickets: "singapore-grand-prix" },
        { name: "United States Grand Prix", city: "Austin", date: "2025-10-19", coords: [30.1339, -97.6411], timeIST: "12:30 AM (Mon)", tickets: "united-states-grand-prix" },
        { name: "Mexican Grand Prix", city: "Mexico City", date: "2025-10-26", coords: [19.4042, -99.0907], timeIST: "01:30 AM (Mon)", tickets: "mexico-city-grand-prix" },
        { name: "Brazilian Grand Prix", city: "SÃ£o Paulo", date: "2025-11-09", coords: [-23.7011, -46.6997], timeIST: "10:30 PM", tickets: "sao-paulo-grand-prix" },
        { name: "Las Vegas Grand Prix", city: "Las Vegas", date: "2025-11-22", coords: [36.1147, -115.1728], timeIST: "11:30 AM", tickets: "las-vegas-grand-prix" },
        { name: "Qatar Grand Prix", city: "Lusail", date: "2025-11-30", coords: [25.4900, 51.4542], timeIST: "09:30 PM", tickets: "qatar-grand-prix" },
        { name: "Abu Dhabi Grand Prix", city: "Abu Dhabi", date: "2025-12-07", coords: [24.4672, 54.6031], timeIST: "06:30 PM", tickets: "abu-dhabi-grand-prix" }
    ];

    // --- Marker Creation and Logic ---
    const currentDate = new Date('2025-06-28T15:00:00Z'); // Set current date for demonstration
    let nextRaceFound = false;

    races.forEach((race, index) => {
        const raceDate = new Date(race.date);
        let color = '#d90429'; // Default Red for upcoming

        if (raceDate < currentDate) {
            color = '#808080'; // Grey for done
        } else if (!nextRaceFound) {
            color = '#28a745'; // Green for next race
            nextRaceFound = true;
        }

        const markerHtml = `<div class="marker-icon" style="background-color:${color}; width: 28px; height: 28px;">${index + 1}</div>`;

        const customIcon = L.divIcon({
            html: markerHtml,
            className: '', // remove default leaflet styles
            iconSize: [28, 28],
            iconAnchor: [14, 14]
        });

        const popupContent = `
            <h3>${race.name}</h3>
            <p><strong>Location:</strong> ${race.city}</p>
            <p><strong>Race Date:</strong> ${race.date}</p>
            <p><strong>Race Time (IST):</strong> ${race.timeIST}</p>
            <p><a href="https://tickets.formula1.com/en/f1-33132-${race.tickets}" target="_blank">Buy Tickets &raquo;</a></p>
            <p><small><em>Timings are subject to change.</em></small></p>
        `;

        L.marker(race.coords, { icon: customIcon })
            .addTo(map)
            .bindPopup(popupContent);
    });

</script>

</body>
</html>
